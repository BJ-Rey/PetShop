<!--pages/mine/mine.wxml-->
<view class="container">
  <!-- åŠ è½½ä¸­æç¤º -->
  <view class="loading-container" wx:if="{{loading}}">
    <image src="/images/åŠ è½½_loading.svg" class="loading-icon"></image>
    <text>åŠ è½½ä¸­...</text>
  </view>

  <block wx:else>
    <!-- ç™»å½•çŠ¶æ€ä¸‹çš„ç”¨æˆ·ä¿¡æ¯åŒº -->
    <view class="user-info" wx:if="{{isLoggedIn}}">
      <view class="avatar">
        <image src="{{userInfo.avatar}}" mode="aspectFill"></image>
      </view>
      <view class="user-details">
        <view class="nickname">{{userInfo.nickname}}</view>
      </view>
    </view>

    <!-- æœªç™»å½•çŠ¶æ€ä¸‹çš„å¤´éƒ¨ -->
    <view class="user-info guest" bindtap="navigateToLogin" wx:else>
      <view class="avatar">
        <image src="/images/default-avatar.png" mode="aspectFill"></image>
      </view>
      <view class="user-details">
        <view class="nickname">ç‚¹å‡»ç™»å½•/æ³¨å†Œ</view>
        <view class="desc">ç™»å½•åäº«å—æ›´å¤šæœåŠ¡</view>
      </view>
      <view class="arrow">â†’</view>
    </view>

    <!-- è®¢å•ç®¡ç†åŒº -->
    <view class="order-section">
      <view class="section-header" bindtap="navigateToAllOrders">
        <text class="title">æˆ‘çš„è®¢å•</text>
        <view class="more">
          <text>æŸ¥çœ‹å…¨éƒ¨</text>
          <text class="arrow">â†’</text>
        </view>
      </view>
      <view class="order-stats">
        <view wx:for="{{orderStats}}" wx:key="status" class="order-stat-item" bindtap="navigateToOrderList" data-status="{{item.status}}">
          <view class="stat-icon">{{item.count > 0 ? 'ğŸ”´' : ''}}</view>
          <view class="stat-count">{{item.count}}</view>
          <view class="stat-name">{{item.name}}</view>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½èœå•åŒº -->
    <view class="menu-section">
      <view class="menu-grid">
        <view wx:for="{{menuItems}}" wx:key="id" class="menu-item" bindtap="navigateToMenu" data-url="{{item.url}}">
          <view class="menu-icon">{{item.icon}}</view>
          <view class="menu-name">{{item.name}}</view>
        </view>
      </view>
    </view>
    
    <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
    <view class="logout-section" wx:if="{{isLoggedIn}}">
      <button class="logout-btn" type="warn" bindtap="logout">é€€å‡ºç™»å½•</button>
    </view>
  </block>

  <!-- æƒé™å¼¹çª—ç»„ä»¶ -->
  <auth-modal id="auth-modal" />
</view>
