<!-- pages/merchant/setting/notification-setting/notification-setting.wxml -->
<view class="container">
  <!-- 顶部操作栏 -->
  <view class="standard-action-bar">
    <text class="standard-back-btn" bindtap="goBack">←</text>
    <text class="page-title">通知设置</text>
  </view>

  <!-- 悬浮保存按钮 -->
  <view class="floating-save-btn" bindtap="saveNotificationSetting">
    <text class="save-icon">💾</text>
    <text>保存</text>
  </view>

  <!-- 订单通知设置 -->
  <view class="setting-section card">
    <view class="section-title">订单通知</view>
    
    <!-- 订单通知总开关 -->
    <view class="form-item toggle-item">
      <view class="form-label">订单通知总开关</view>
      <switch 
        checked="{{orderNotification.enabled}}" 
        bindchange="toggleOrderNotificationEnabled"
      />
    </view>
    
    <!-- 订单通知详细设置 -->
    <view class="notification-detail" wx:if="{{orderNotification.enabled}}">
      <!-- 新订单通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">📦</text>
          <text>新订单通知</text>
        </view>
        <switch 
          checked="{{orderNotification.newOrder}}" 
          bindchange="toggleOrderNotificationItem" 
          data-type="newOrder"
        />
      </view>
      
      <!-- 订单状态变化通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">🔄</text>
          <text>订单状态变化通知</text>
        </view>
        <switch 
          checked="{{orderNotification.statusChange}}" 
          bindchange="toggleOrderNotificationItem" 
          data-type="statusChange"
        />
      </view>
      
      <!-- 订单取消通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">❌</text>
          <text>订单取消通知</text>
        </view>
        <switch 
          checked="{{orderNotification.cancelled}}" 
          bindchange="toggleOrderNotificationItem" 
          data-type="cancelled"
        />
      </view>
      
      <!-- 订单退款通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">🔄</text>
          <text>订单退款通知</text>
        </view>
        <switch 
          checked="{{orderNotification.refunded}}" 
          bindchange="toggleOrderNotificationItem" 
          data-type="refunded"
        />
      </view>
      
      <!-- 订单完成通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">✅</text>
          <text>订单完成通知</text>
        </view>
        <switch 
          checked="{{orderNotification.completed}}" 
          bindchange="toggleOrderNotificationItem" 
          data-type="completed"
        />
      </view>
      
      <!-- 通知接收方式 -->
      <view class="form-item">
        <text class="form-label">通知接收方式</text>
        <checkbox-group class="checkbox-group" bindchange="changeOrderNotificationChannels">
          <label class="checkbox-item" wx:for="{{notificationChannels}}" wx:key="value">
            <checkbox 
              value="{{item.value}}" 
              checked="{{orderNotification.channels.includes(item.value)}}" 
            />
            <text>{{item.name}}</text>
          </label>
        </checkbox-group>
      </view>
    </view>
  </view>

  <!-- 客户消息通知设置 -->
  <view class="setting-section card">
    <view class="section-title">客户消息通知</view>
    
    <!-- 客户消息通知总开关 -->
    <view class="form-item toggle-item">
      <view class="form-label">客户消息通知总开关</view>
      <switch 
        checked="{{customerNotification.enabled}}" 
        bindchange="toggleCustomerNotificationEnabled"
      />
    </view>
    
    <!-- 客户消息通知详细设置 -->
    <view class="notification-detail" wx:if="{{customerNotification.enabled}}">
      <!-- 客户咨询通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">👤</text>
          <text>客户咨询通知</text>
        </view>
        <switch 
          checked="{{customerNotification.consultation}}" 
          bindchange="toggleCustomerNotificationItem" 
          data-type="consultation"
        />
      </view>
      
      <!-- 客户评价通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">⭐</text>
          <text>客户评价通知</text>
        </view>
        <switch 
          checked="{{customerNotification.review}}" 
          bindchange="toggleCustomerNotificationItem" 
          data-type="review"
        />
      </view>
      
      <!-- 客户投诉通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">⚠️</text>
          <text>客户投诉通知</text>
        </view>
        <switch 
          checked="{{customerNotification.complaint}}" 
          bindchange="toggleCustomerNotificationItem" 
          data-type="complaint"
        />
      </view>
      
      <!-- 客户建议通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">💡</text>
          <text>客户建议通知</text>
        </view>
        <switch 
          checked="{{customerNotification.suggestion}}" 
          bindchange="toggleCustomerNotificationItem" 
          data-type="suggestion"
        />
      </view>
      
      <!-- 通知接收方式 -->
      <view class="form-item">
        <text class="form-label">通知接收方式</text>
        <checkbox-group class="checkbox-group" bindchange="changeCustomerNotificationChannels">
          <label class="checkbox-item" wx:for="{{notificationChannels}}" wx:key="value">
            <checkbox 
              value="{{item.value}}" 
              checked="{{customerNotification.channels.includes(item.value)}}" 
            />
            <text>{{item.name}}</text>
          </label>
        </checkbox-group>
      </view>
    </view>
  </view>

  <!-- 财务通知设置 -->
  <view class="setting-section card">
    <view class="section-title">财务通知</view>
    
    <!-- 财务通知总开关 -->
    <view class="form-item toggle-item">
      <view class="form-label">财务通知总开关</view>
      <switch 
        checked="{{financeNotification.enabled}}" 
        bindchange="toggleFinanceNotificationEnabled"
      />
    </view>
    
    <!-- 财务通知详细设置 -->
    <view class="notification-detail" wx:if="{{financeNotification.enabled}}">
      <!-- 交易明细通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">💰</text>
          <text>交易明细通知</text>
        </view>
        <switch 
          checked="{{financeNotification.transaction}}" 
          bindchange="toggleFinanceNotificationItem" 
          data-type="transaction"
        />
      </view>
      
      <!-- 结算提醒通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">📊</text>
          <text>结算提醒通知</text>
        </view>
        <switch 
          checked="{{financeNotification.settlement}}" 
          bindchange="toggleFinanceNotificationItem" 
          data-type="settlement"
        />
      </view>
      
      <!-- 发票状态通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">📄</text>
          <text>发票状态通知</text>
        </view>
        <switch 
          checked="{{financeNotification.invoice}}" 
          bindchange="toggleFinanceNotificationItem" 
          data-type="invoice"
        />
      </view>
      
      <!-- 提现通知 -->
      <view class="form-item toggle-item">
        <view class="form-label">
          <text class="form-icon">💸</text>
          <text>提现通知</text>
        </view>
        <switch 
          checked="{{financeNotification.withdraw}}" 
          bindchange="toggleFinanceNotificationItem" 
          data-type="withdraw"
        />
      </view>
      
      <!-- 通知接收方式 -->
      <view class="form-item">
        <text class="form-label">通知接收方式</text>
        <checkbox-group class="checkbox-group" bindchange="changeFinanceNotificationChannels">
          <label class="checkbox-item" wx:for="{{notificationChannels}}" wx:key="value">
            <checkbox 
              value="{{item.value}}" 
              checked="{{financeNotification.channels.includes(item.value)}}" 
            />
            <text>{{item.name}}</text>
          </label>
        </checkbox-group>
      </view>
    </view>
  </view>

  <!-- 通知接收人设置 -->
  <view class="setting-section card">
    <view class="section-title">通知接收人</view>
    
    <!-- 接收人列表 -->
    <view class="recipient-list" wx:if="{{recipients.length > 0}}">
      <view class="recipient-item" wx:for="{{recipients}}" wx:key="id">
        <view class="recipient-info">
          <text class="recipient-name">{{item.name}}</text>
          <text class="recipient-phone">{{item.phone}}</text>
        </view>
        <view class="recipient-actions">
          <button class="edit-btn" bindtap="editRecipient" data-id="{{item.id}}">编辑</button>
          <button class="delete-btn" bindtap="deleteRecipient" data-id="{{item.id}}">删除</button>
        </view>
      </view>
    </view>
    
    <!-- 添加接收人按钮 -->
    <button class="add-recipient-btn" bindtap="addRecipient">+ 添加接收人</button>
  </view>
</view>