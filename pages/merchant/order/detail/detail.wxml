<!-- pages/merchant/order/detail/detail.wxml -->
<view class="container">
  <!-- é¡¶éƒ¨æ“ä½œæ  -->
  <view class="standard-action-bar">
    <text class="standard-back-btn" bindtap="navigateBack">â†</text>
    <text class="page-title">è®¢å•è¯¦æƒ…</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- è®¢å•è¯¦æƒ… -->
  <view class="order-detail" wx:elif="{{order}}">
    <!-- è®¢å•çŠ¶æ€ -->
    <view class="order-status-section card">
      <view class="status-header">
        <text class="status-title">è®¢å•çŠ¶æ€</text>
        <text class="status-value {{order.status}}">
          {{order.status === 'pending' ? 'å¾…ä»˜æ¬¾' : order.status === 'processing' ? 'å¾…å‘è´§' : order.status === 'shipped' ? 'å¾…æ”¶è´§' : order.status === 'completed' ? 'å·²å®Œæˆ' : order.status === 'cancelled' ? 'å·²å–æ¶ˆ' : 'æœªçŸ¥çŠ¶æ€'}}
        </text>
      </view>
    </view>

    <!-- è®¢å•åŸºæœ¬ä¿¡æ¯ -->
    <view class="order-info-section card">
      <view class="info-item">
        <text class="info-label">è®¢å•ç¼–å·</text>
        <text class="info-value">{{order.orderNumber}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åˆ›å»ºæ—¶é—´</text>
        <text class="info-value">{{order.createdAt}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ›´æ–°æ—¶é—´</text>
        <text class="info-value">{{order.updatedAt}}</text>
      </view>
      <view class="info-item" wx:if="{{order.trackingNumber}}">
        <text class="info-label">è¿å•å·</text>
        <text class="info-value">{{order.trackingNumber}}</text>
      </view>
    </view>

    <!-- å®¢æˆ·ä¿¡æ¯ -->
    <view class="customer-info-section card">
      <view class="section-title">å®¢æˆ·ä¿¡æ¯</view>
      <view class="customer-item">
        <text class="customer-label">å®¢æˆ·å§“å</text>
        <text class="customer-value">{{order.customer.name}}</text>
      </view>
      <view class="customer-item">
        <text class="customer-label">è”ç³»ç”µè¯</text>
        <text class="customer-value">{{order.customer.phone}}</text>
      </view>
      <view class="customer-item">
        <text class="customer-label">æ”¶è´§åœ°å€</text>
        <text class="customer-value">{{order.customer.address}}</text>
      </view>
    </view>

    <!-- å•†å“ä¿¡æ¯ -->
    <view class="products-section card">
      <view class="section-title">å•†å“ä¿¡æ¯</view>
      <view class="product-list">
        <view class="product-item" wx:for="{{order.products}}" wx:key="id">
          <image class="product-image" src="{{item.image}}"></image>
          <view class="product-info">
            <text class="product-name">{{item.name}}</text>
            <text class="product-spec">è§„æ ¼ï¼š{{item.spec}}</text>
          </view>
          <view class="product-quantity">x{{item.quantity}}</view>
          <view class="product-price">Â¥{{item.price}}</view>
        </view>
      </view>
    </view>

    <!-- é‡‘é¢ä¿¡æ¯ -->
    <view class="amount-section card">
      <view class="amount-item">
        <text class="amount-label">å•†å“æ€»é¢</text>
        <text class="amount-value">Â¥{{order.subtotal}}</text>
      </view>
      <view class="amount-item">
        <text class="amount-label">è¿è´¹</text>
        <text class="amount-value">Â¥{{order.shippingFee}}</text>
      </view>
      <view class="amount-item total">
        <text class="amount-label">è®¢å•æ€»é¢</text>
        <text class="amount-value">Â¥{{order.total}}</text>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-section">
      <!-- æ ¹æ®è®¢å•çŠ¶æ€æ˜¾ç¤ºä¸åŒçš„æ“ä½œæŒ‰é’® -->
      <button 
        class="action-btn primary-btn" 
        bindtap="confirmPayment"
        wx:if="{{order.status === 'pending'}}"
      >
        ç¡®è®¤ä»˜æ¬¾
      </button>
      
      <button 
        class="action-btn primary-btn" 
        bindtap="shipOrder"
        wx:if="{{order.status === 'processing'}}"
      >
        å‘è´§
      </button>
      
      <button 
        class="action-btn primary-btn" 
        bindtap="confirmDelivery"
        wx:if="{{order.status === 'shipped'}}"
      >
        ç¡®è®¤æ”¶è´§
      </button>
      
      <button 
        class="action-btn danger-btn" 
        bindtap="cancelOrder"
        wx:if="{{order.status === 'pending' || order.status === 'processing'}}"
      >
        å–æ¶ˆè®¢å•
      </button>
    </view>
  </view>

  <!-- è®¢å•ä¸å­˜åœ¨ -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">ğŸ“‹</text>
    <text class="empty-text">è®¢å•ä¸å­˜åœ¨</text>
    <button class="back-btn" bindtap="navigateBack">è¿”å›è®¢å•åˆ—è¡¨</button>
  </view>
</view>